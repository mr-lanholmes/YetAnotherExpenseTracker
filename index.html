<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YA! Expense Tracker</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://bootswatch.com/5/flatly/bootstrap.css">
	
    <style>
		.icon{
			max-width: 50px
		}
    </style>
</head>
<body id="mainBody" class="">
    <div class="container-fluid vh-100 d-flex" style="flex-direction: column">
		<div class="row mt-5">
			<input type="date" class="d-none" id="dateSelector" onChange="changeDate(this)" />
			<div class="col fs-3 text-center text-middle my-auto" id="displayDate" onClick="document.getElementById('dateSelector').showPicker()">
				0
			</div>
		</div>
		<div class="row flex-fill">
			<div class="col fs-1 text-center text-middle my-auto" id="display">0</div>
		</div>
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">7</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">8</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">9</button>
			</div>
		</div>
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">4</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">5</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">6</button>
			</div>
		</div>
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">1</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">2</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">3</button>
			</div>
		</div>
		<div class="row mt-2 mb-5">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="clearDisplay()">&larr; Del</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">0</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-light fs-2" onclick="addToDisplay(this)">.</button>
			</div>
		</div>
	</div>
    <div class="container-fluid">
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'breakfast')">
					<img src="./breakfast.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'lunch')">
					<img src="./lunch.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'dinner')">
					<img src="./dinner.png" class="icon" />
				</button>
			</div>
		</div>
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'snack')">
					<img src="./snack.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'beverages')">
					<img src="./beverages.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'grocery')">
					<img src="./grocery.png" class="icon" />
				</button>
			</div>
		</div>
		<div class="row mt-2">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'public-transport')">
					<img src="./public-transport.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'taxi')">
					<img src="./taxi.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'telco')">
					<img src="./telco.png" class="icon" />
				</button>
			</div>
		</div>
		<div class="row mt-2 mb-5">
			<div class="col d-grid" style="min-height: 88px">
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'bill')">
					<img src="./bill.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'medicine')">
					<img src="./medicine.png" class="icon" />
				</button>
			</div>
		</div>
		<div class="row mt-2 mb-5">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'family')">
					<img src="./friend.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'family')">
					<img src="./family.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'couple')">
					<img src="./couple-colour.png" class="icon" />
				</button>
			</div>
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn fs-2" role="button" data-bs-toggle="button" onclick="addToSpendType(this, 'office')">
					<img src="./group.png" class="icon" />
				</button>
			</div>
		</div>
	</div>
    <div class="container-fluid mt-2">
		<div class="row">
			<div class="col fs-1 text-center" id="final_numeric">
			</div>
		</div>
		<div class="row">
			<div class="col fs-5 text-center" id="final_spend_types">
			</div>
		</div>
	</div>
    <div class="container-fluid mt-2">
		<div class="row">
			<div class="col d-grid" style="min-height: 88px">
				<div class="form-floating mb-3">
					<input type="text" class="form-control" id="expenseNotes" placeholder="Expense Notes">
					<label for="floatingInput">Expense Notes</label>
				</div>
			</div>
		</div>
	</div>
    <div class="container-fluid mt-2">
		<div class="row mb-5">
			<div class="col d-grid" style="min-height: 88px">
				<button class="btn btn-success fs-2" onclick="submitSpending()">
					<img src="./submit.png" class="icon" />
				</button>
			</div>
		</div>
	</div>
    <!-- <div class="container-fluid mt-3 mb-3">
		<div class="row mb-5">
			<div class="col">
				<table class="table">
					<thead>
					  <tr>
						<th scope="col">#</th>
						<th scope="col">First</th>
						<th scope="col">Last</th>
						<th scope="col">Handle</th>
					  </tr>
					</thead>
					<tbody id="tblBody">
					</tbody>
				</table>
			</div>
		</div>
	</div> -->
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    
    <script>
		var lcy = "S$"
		var spendTypes = [ ];
		let itemsArray = localStorage.getItem('items') ? JSON.parse(localStorage.getItem('items')) : [ ];
		
		
		function setDate(d){
			var currDate = d.getDate();
			var currMonth = d.getMonth();
			var currYear = d.getFullYear();
			var dateStr = currYear + "-" + currMonth + "-" + currDate;
			document.getElementById("dateSelector").valueAsDate = d
			document.getElementById("displayDate").innerHTML = moment(document.getElementById("dateSelector").valueAsDate).format('dddd, DD MMM YYYY');
		}
		setDate(new Date());

		function changeDate(component){
			setDate(component.valueAsDate)
		}

        function addToDisplay(component) {
			var prevNumber = document.getElementById('display').innerHTML
			if(prevNumber=='0'){
				document.getElementById('display').innerHTML = component.innerHTML
				return
			}
			document.getElementById('display').innerHTML += component.innerHTML
						
			var t = document.getElementById('display').innerHTML;
			document.getElementById('display').innerHTML = t.indexOf(".") >= 0 ? t.slice(0, t.indexOf(".") + 3) : t;
			
        }

		function addToSpendType(component, name){
			document.getElementById('final_numeric').innerHTML = lcy + " " + document.getElementById('display').innerHTML
			
			if(component.getAttribute('aria-pressed') == "true"){
				spendTypes.push(name.toUpperCase())
			}else{
				spendTypes = spendTypes.filter(e => e !== name.toUpperCase())
			}
			document.getElementById('final_spend_types').innerHTML = spendTypes.join(", ")
		}
        
        function clearDisplay() {
			var prevNumber = document.getElementById('display').innerHTML
			if(document.getElementById('display').innerHTML.length > 0){
				document.getElementById('display').innerHTML = prevNumber.substring(0, prevNumber.length - 1)
			}
		}

		function resetForm(){
			document.getElementById("display").innerHTML = "0";
			document.getElementById('final_numeric').innerHTML = lcy + " 0";
			document.getElementById('final_spend_types').innerHTML = "";
			document.getElementById('expenseNotes').value = "";
			
			// Loop through buttons and aria-pressed if true set false

			// document.body.scrollTop = 0; // For Safari
			// document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
		}

		function submitSpending(){
			
			itemsArray.push({
				expenseValue: document.getElementById('display').innerHTML,
				expenseTypes: spendTypes,
				expenseDate: document.getElementById("displayDate").innerHTML,
				expenseInputDateTime: new Date(),
				expenseNotes: document.getElementById('expenseNotes').value,
			})

  			localStorage.setItem('items', JSON.stringify(itemsArray));

			document.getElementById("mainBody").scrollIntoView(true);
			document.getElementById("mainBody").focus()
				resetForm()

			// Swal.fire({
			// 	icon: 'success',
			// 	title: 'OK',
			// 	text: 'Submitted',
			// }).then(() => {
			// })

		}
		
    </script>
</body>
</html>
